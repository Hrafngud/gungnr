## Iteration Log

- 2026-01-19: Moved the CLI TUI logo to a centered header layout.
  - Centered the ASCII logo at the top and placed the rest of the UI below it.
  - Adjusted layout sizing so the logo only renders when it fits the viewport.
- 2026-01-19: Addressed CLI cancellation and log visibility regressions.
  - Short-circuited the step loop when the run context is canceled.
  - Auto-scrolled the TUI log viewport to keep new messages visible.
- 2026-01-19: Repositioned the CLI TUI logo to avoid clipping.
  - Rendered the logo in its own right-side column spanning full height.
  - Recomputed layout sizing so the log/prompt panel fits the terminal height.
- 2026-01-19: Added the ASCII logo to the bootstrap TUI.
  - Embedded `cmd/gungnr/ascii-art.txt` in the CLI and wired it into the TUI.
  - Rendered the logo alongside the log/prompt panel with width-aware layout.
- 2026-01-21: Added a detailed CLI restructure + Bubbletea TUI plan.
  - Documented package layout, step runner, standardized messaging, and TUI flow in cli_plan.md.
  - Updated next_task.md to focus on implementing the CLI refactor and TUI.
- 2026-01-19: Added secondary domain support for tunnel ingress and UI selection.
  - Stored additional domains in settings with validation, and used selected domain when updating tunnel ingress.
  - Added Networking domains config sidebar/listing and domain selectors in quick deploy forms.
- 2026-01-19: Split Home > Quick Deploy forms into dedicated components.
  - Added template, existing-forward, and quick service form components to reduce HomeView complexity.
  - Kept form behavior, field guidance, and job feedback unchanged while decoupling UI sections.
- 2026-01-19: Simplified Home > Live runtime signals layout using Tailwind-only flex rows.
  - Removed custom runtime-signal column CSS.
  - Placed Automation queue on its own row with inline status counts.
  - Compact layout to keep the host status panel slimmer.
- 2026-01-21: Updated the global loading overlay presentation.
  - Replaced the overlay card/spinner with a centered loading.gif.
  - Switched the overlay background to solid black and tuned gif sizing.
- 2026-01-19: Reduced Host Settings to template-only credentials and softened UI language around bootstrap-complete Cloudflare status.
  - Removed base domain/Cloudflare overrides, config import/export, and related copy from Host Settings.
  - Routed template configuration links to Host Settings and updated Home/GitHub/Networking copy to focus on availability.
- 2026-01-19: Refined Home > Host status runtime signals layout to reduce vertical bloat.
  - Replaced the grid with a flex-based column layout for denser, more balanced card stacking.
  - Grouped related signals into three columns to minimize blank space.
- 2026-01-19: Softened remaining dashboard/overview/jobs/logs copy to avoid post-bootstrap setup language.
  - Reframed dashboard, job timeline, and log guidance to availability/monitoring language.
  - Shifted GitHub status labels to availability wording and removed PAT mentions.
- 2026-01-19: Cleaned Home and Host Settings copy to remove setup phrasing and removed unused template port fields.
  - Reworded template empty states to availability language.
  - Dropped proxy/db port fields from template form payload and trimmed Host Settings header copy.
- 2026-01-20: Redirected bootstrap cloudflared tunnel logs to a file so the CLI remains usable.
  - `gungnr bootstrap` now writes tunnel output to `~/.cloudflared/cloudflared.log` and prints the path in the summary.
- 2026-01-20: Adjusted bootstrap tunnel readiness check to accept active connectors from `cloudflared tunnel info`.
  - Treats connector rows as a successful tunnel signal when active-connection counters are absent.
- 2026-01-17: Improved bootstrap CLI prompts for GitHub and Cloudflare inputs.
  - Added GitHub OAuth App link before device flow client ID prompt.
  - Added Cloudflare API token links/permissions and normalized token input to strip Authorization/Bearer prefixes.
- 2026-01-17: Cleaned Cloudflare/OAuth setup copy to assume bootstrap-complete state.
  - Reframed Host Settings and Networking guidance as inspection/rotation-only.
  - Updated Home and Templates copy to reference the host tunnel without setup phrasing.
- 2026-01-20: Aligned README with bootstrap-first flow.
  - Reframed requirements as bootstrap inputs and kept Host Settings as inspection/adjustments only.
  - Removed post-bootstrap OAuth callback and cloudflared config troubleshooting steps.
- 2026-01-05: Scoped GitHub App setup to template creation.
  - Labeled GitHub App settings as template-only, disabled create-from-template when app credentials are missing, and added concise guidance in the template card and form.
- 2026-01-17: Wired `gungnr bootstrap` to start Docker Compose with the generated `.env`, wait for `/healthz`, and print the panel URL after services are ready.
- 2026-01-18: Added bootstrap `.env` generation and Gungnr data directory creation in the CLI.
  - `gungnr bootstrap` now builds a complete `.env` with GitHub identity, Cloudflare tunnel details, domain, and cloudflared paths.
  - Bootstrapping creates `~/gungnr` with `templates` and `state` subfolders and writes the `.env` there.
  - Added summary output and new prompts for GitHub client secret + callback URL.
- 2026-01-18: Added cloudflared config generation to `gungnr bootstrap`, install/start as a system service, and tunnel status validation.
- 2026-01-18: Switched `gungnr bootstrap` to run cloudflared via CLI (no systemd).
  - Removed cloudflared service install/start logic and sudo/systemctl usage.
  - Start tunnel with `cloudflared tunnel run --config <path> <tunnel-name>` and keep health check via `tunnel info`.
- 2026-01-18: Added explicit CLI output note that cloudflared runs as the current user and persistence is out of scope.
- 2026-01-18: Added Cloudflare DNS routing to `gungnr bootstrap`, prompting for base domain + API token, validating zone/account access, creating the DNS route, and confirming the record.
- 2026-01-17: Implemented cloudflared tunnel login + creation in `gungnr bootstrap`, including credential wait and tunnel UUID/name output.
- 2026-01-17: Extended `gungnr bootstrap` preflight checks to detect existing installs and validate default filesystem paths.
- 2026-01-17: Added initial Go `gungnr` CLI with `bootstrap` preflight checks for Docker access, Docker Compose availability, and cloudflared presence.
- 2026-01-17: Added repo-root `install.sh` to install the Gungnr CLI, detect OS/arch, and verify/install Docker, Docker Compose, and cloudflared.
- 2026-01-19: Removed setup-oriented copy from the Home host status panel and softened GitHub status labels away from “setup” language.
- 2026-01-17: Added Gungnr logo usage in header/login and swapped loading spinners to use the new loading.gif.
- 2026-01-17: Rebranded legacy product naming to Gungnr across docs, UI copy, and CLI naming.
- 2026-01-17: Re-aligned plans to the bootstrap-first install approach.
  - Updated overall, backend, and frontend plans to reflect install.sh + gungnr CLI + UI cleanup phases.
  - Set the next task to implement the installer script; backend API/DB changes are frozen.
- 2026-01-17: Implemented GitHub device flow in the CLI bootstrap.
  - Added device authorization prompt, polling, and GitHub user lookup.
  - Captured and printed the GitHub login and numeric user ID for later bootstrap steps.
- 2026-01-08: Desktop responsiveness pass across main views.
  - Added flex-wrap + break-word handling to list rows and panel headers to prevent clipped labels/values.
  - Switched key grids to minmax column definitions for safer shrink on desktop aspect ratios.
  - Enabled word breaking in log/metadata output and set panels/list rows to allow shrink/wrap.
- 2026-01-08: Improved Logs view top controls responsiveness.
  - Reworked the log controls panel into a grid with wrapped control groups.
  - Added flexible widths and basis rules to prevent overlap/clipping at desktop breakpoints.
- 2026-01-08: Added settings import/export and reveal controls in the Host Settings sidebar.
  - Added eye toggle buttons for GitHub App client secret and Cloudflare API token fields.
  - Added Export/Import config buttons with JSON download and file-based form population.
- 2026-01-08: Removed deprecated env allowlist settings from config, compose, and docs.
  - GitHub catalog payload no longer reports env allowlist data.
  - Updated auth docs to reflect DB-backed allowlist only.
- 2026-01-08: Added jobs pagination backend + UI support.
  - Jobs list now accepts page/limit and returns total/page metadata.
  - Jobs store tracks pagination state and the Jobs view shows previous/next controls with range info.
- 2026-01-07: Added planning notes to auto-resolve GitHub App installation IDs via app JWT endpoints (avoid manual entry).
- 2026-01-07: Added planning task for a Not Authorized screen after denied login attempts.
- 2026-01-07: Added planning task for Jobs list pagination (backend + frontend).
- 2026-01-07: Stacked Home GitHub-backed stack cards vertically, removed template source row from forward card, and added accent icon buttons.
- 2026-01-07: Added allowlist add/remove support with role-aware access.
  - Added admin-only endpoints to create and delete allowlist users and opened user list to all authenticated roles.
  - Resolved GitHub usernames via the public API, preserved login casing, and blocked superuser removal.
  - Updated Users UI with add/remove controls, view-only messaging for non-admins, and route/nav access for all roles.
- 2026-01-05: Locked down host/Docker mutation endpoints and project lifecycle actions behind admin roles.
  - Added admin-role checks to Docker stop/restart/remove and template lifecycle endpoints while leaving read-only endpoints accessible.
- 2026-01-07: Added RBAC enforcement for settings updates and fixed compose env wiring.
  - Passed `SUPERUSER_GH_NAME` and `SUPER_GH_ID` through the API service in `docker-compose.yml`.
  - Guarded `PUT /api/v1/settings` so only Admin/SuperUser can update settings; non-admins now get 403 while reads still work.
- 2026-01-07: Ran backend/frontend build checks and gated Host Settings + GitHub pages for non-admins.
  - Build checks: `go build ./cmd/server` and `npm run build` in `frontend/go-notes`.
  - Disabled Host Settings save flow for non-admins and added read-only indicators on Host Settings and GitHub views.
- 2026-01-06: Added RBAC Users UI and role-aware navigation.
  - Added Users view with list, last login formatting, and admin/user role updates.
  - Wired /api/v1/users list + role update service calls with toast feedback.
  - Added role fields to auth type/store and gated Users nav + route for Admin/SuperUser.
  - Added Users nav icon.
- 2026-01-06: Added RBAC user management endpoints with SuperUser guard.
  - Added `/api/v1/users` list and `/api/v1/users/:id/role` role update (admin/user only).
  - Enforced last-superuser demotion protection and wired RequireSuperUser middleware for these routes.
- 2026-01-06: Clarified SuperUser cap enforcement error messaging during startup seeding.
- 2026-01-06: Began Phase 2 security planning for RBAC.
  - Updated overall plan to highlight Phase 2 security layer and RBAC milestones.
  - Added step-by-step RBAC plan to backend and frontend planning files.
  - Set next task to implement RBAC data model and SuperUser seed/guard.
- 2026-01-06: Noted likely users table wipe before RBAC seeding to avoid legacy allowlist state.
- 2026-01-06: Documented the current OAuth auth flow.
  - Added `auth.md` describing GitHub OAuth, session cookies, allowlists, callback handling, and the optional test token.
- 2026-01-06: Diagnosed and fixed create_template job failure on log streaming shutdown.
  - Root cause: `runLoggedCommand` called `cmd.Wait()` before log readers completed, yielding `read |0: file already closed` from scanner and marking jobs failed even when compose exited 0.
  - Fix: wait for stdout/stderr readers to finish before `Wait`, and ignore `os.ErrClosed` in scanners to avoid false failures.
- 2026-01-06: Queued diagnosis task for job 91 failure (`read |0: file already closed`) after docker compose start.
- 2026-01-06: Marked the Docker usage summary task as already completed; no new tasks queued.
- 2026-01-06: Guarded legacy host-worker cleanup against missing columns.
  - Added jobs table presence check and column discovery before clearing legacy host tokens.
  - Cleanup now skips the update when `host_token` columns are absent, avoiding fresh-db warnings.
- 2026-01-04: New GitHub template repo lookup error observed.
  - Error: `template repo lookup failed: GET https://api.github.com/repos/Hrafngud/go-ground: 404 Not Found` using the GitHub App installation token.
  - Next task set to diagnose access/installation scope vs repo visibility, review docs, and propose a concise fix plan.
- 2026-01-04: Debugged template generation 404 and added GitHub template preflight validation.
  - Added template repo validation (access + is_template) before `generate`, with clearer error messaging and repo name normalization.
  - Documented the template-repo requirement in `backend_plan.md`.
- 2026-01-04: Removed PAT references and fallback logic; create-from-template now requires GitHub App installation tokens only. Updated UI guidance and GitHub page copy to reflect App-only flow and removed PAT settings field.
- 2026-01-04: Clarified GitHub token/App permissions in Host Settings guidance and helper text for GitHub access fields.
- 2026-01-04: Added GitHub App credential status panel to GitHub page with backend catalog fields for App ID/Installation ID/Private Key status. Fixed strict null checks in `TemplateCardsSection` and `HomeView`. Ran `npm run build` successfully.
- 2026-01-05: Guarded create-from-template settings access to avoid nil dereference.
  - Added early settings nil check in `handleCreateTemplate` to return a clear error before resolving config or accessing GitHub app settings.
- 2026-01-05: Implemented RBAC allowlist seeding and enforcement.
  - Added `role` to users with a default of `user` plus superuser seeding/cap enforcement on startup.
  - OAuth now checks the DB allowlist (GitHub ID) and denies users not present.
- 2026-01-02: User initiated a major visual rework. Pivoting from previous tasks.
- 2026-01-03 (Session 1): Starting UI-REWORK-1 - removing rounded containers, reducing margins, adding custom hr separators.
  - Completed UI-REWORK-1: Removed border-radius from all panel, list-row, state, modal, toast, and onboarding classes in style.css. Horizontal margins already at 5% (`px-[5%]` in AppShell.vue). Added `<hr />` separators to HomeView, OverviewView, ActivityView, GitHubView, HostSettingsView, JobsView, and NetworkingView.
  - Completed UI-REWORK-2: Created UiFormSidePanel component with right-side slide-in animation, overlay, scrollable content, and close button.
  - Completed UI-REWORK-3: Refactored template creation form in HomeView to use the new FormSidePanel component.
- 2026-01-03 (Session 2): Completing UI-REWORK-4 - refactoring all remaining forms.
  - Refactored HomeView: All three forms (template creation, deploy existing, quick service) now use FormSidePanel component with proper state management.
  - Refactored HostSettingsView: Settings form now uses FormSidePanel with status indicators included in the panel.
  - All forms in the application now consistently use the FormSidePanel approach.
- 2026-01-03 (Session 2 continued): User requested additional UI rework tasks.
  - Added UI-REWORK-5: Componentize HomeView for better maintainability and reusability.
  - Added UI-REWORK-6: Standardize sidebar animations across navigation and form sidebars.
- 2026-01-03 (Session 3): Completed UI-REWORK-5 and UI-REWORK-6.
  - Created three new components in /components/home/: HostStatusPanel.vue, TemplateCardsSection.vue, ServiceCardsSection.vue.
  - Refactored HomeView.vue to use the new components, reducing it from 1204 lines to 775 lines (35.6% reduction).
  - Added smooth sidebar animations to AppShell.vue with consistent timing (0.3s ease for width, 0.25s ease for opacity).
  - Standardized all sidebar and modal transitions: navigation sidebar (0.3s), form sidebars (0.3s), modal overlay (0.25s).
  - Frontend visual rework is now complete.
- 2026-01-03 (Session 4): Planning phase for UX refinement cycle.
  - User reviewed deploy.sh script context and identified UX improvements needed.
  - Defined 6 new UX-REFINE tasks focusing on: Quick Services polish, contextual guidance system, ingress preview sidebar, DNS grid layout, and template form simplification.
  - Key insight: "Deploy existing" should forward ANY localhost service (not just Docker) via Cloudflare-only approach.
  - Key insight: "Create from template" should auto-infer ports and require only project name + subdomain.
  - Backend planning for GitHub/Templates integration deferred for future discussion.
- 2026-01-03 (Session 5): Completed UX-REFINE-1, UX-REFINE-4, UX-REFINE-5, and UX-REFINE-6.
  - UX-REFINE-1: Quick Services improvements.
    - Added icon field to ServicePreset type and assigned icons to all 20 service presets (draw, ai, database, cache, server, storage, mail, tool, admin, code, git, search).
    - Implemented search bar with icon for filtering services by name/description.
    - Added service-specific icons to each card with proper icon mapping using inline SVG paths.
    - Set fixed-height scrollable container (368px) with empty state message for no search results.
    - Quick Services section now has consistent visual hierarchy and improved discoverability.
  - UX-REFINE-5: Simplified "Create from template" form.
    - Removed Proxy Port and Database Port fields (now auto-inferred by backend).
    - Made Subdomain field required instead of optional.
    - Updated form description to clarify automatic port configuration.
    - Added field-level help text explaining each input's purpose.
  - UX-REFINE-6: Clarified "Deploy existing" form (renamed to "Forward localhost service").
    - Renamed from "Deploy existing" to "Forward localhost service" to better reflect purpose.
    - Updated to forward ANY localhost service (Docker or not) via Cloudflare-only approach.
    - Changed fields: Service name (required), Subdomain (required), Running at (required localhost port).
    - Removed Docker-specific UI elements (local project list, template folder references).
    - Updated template card descriptions to match new form purposes.
  - UX-REFINE-4: Converted DNS records to 4-column grid layout.
    - Replaced vertical UiListRow layout with compact 4-column grid (Subdomain, Full hostname, Type, Target service).
    - Added header row with column labels.
    - Each DNS record now displays as a single row with all information visible at a glance.
    - Applied truncate to prevent long values from breaking the layout.
- 2026-01-03 (Session 6): Completed UX-REFINE-2 and UX-REFINE-3.
  - UX-REFINE-2: Replaced onboarding overlay with contextual field guidance on form focus.
    - Added reusable UiFieldGuidance with left-side placement and external token links where needed.
    - Wired guidance into all form fields in Home and Host Settings.
    - Removed overlay-driven onboarding buttons from Home, Host Settings, Networking, and GitHub.
  - UX-REFINE-3: Converted ingress previews into right-side panels.
    - Added ingress preview side panels in Host Settings and Networking with refresh controls.
    - Simplified the main layouts by removing inline preview panels.
- 2026-01-03 (Session 7): Cleanup + copy review.
  - Removed all onboarding overlay/store/service/type references and onboarding CSS.
  - Scrubbed remaining onboarding data attributes and labels.
  - Reviewed guidance copy/links for accuracy and kept token docs references intact.
- 2026-01-03 (Session 8): Backend onboarding removal.
  - Deleted onboarding API/controller/service/repository/model and stopped AutoMigrate from creating onboarding tables.
  - Removed onboarding routes from the router and server dependency wiring.
- 2026-01-03 (Session 9): Cleanup per user request.
  - Cleared the remaining Next up items as requested (no action taken).
- 2026-01-03 (Session 10): Planning-only update for backend/frontend improvements.
  - Added planning tasks for GitHub template generation, template catalog UI, localhost forwarding, and container filters.
  - Noted requirement for GitHub App token + permissions and Cloudflare-only forwarding flow.
  - Prepared checklist items for Docker usage stats and stopped container support.
- 2026-01-03 (Session 11): Added more planning tasks for container project filters and UI polish.
  - Added tasks for sidebar auth indicator, global loading overlay, iconography, and logout redirect.
- 2026-01-03 (Session 12): Captured GitHub template generate endpoint details.
  - Documented `POST /repos/{template_owner}/{template_repo}/generate` params, payload, and response in `backend_plan.md`.
  - Noted token types supported and required fine-grained permissions (Administration write, Contents read).
- 2026-01-03 (Session 13): Completed GitHub App token planning and Home template selector.
  - Documented GitHub App installation token permissions, installation requirements, and storage strategy in `backend_plan.md`.
  - Added template catalog + allowlist workflow details in `backend_plan.md`.
  - Added template repo selector + empty state messaging to the Home create-from-template panel.
- 2026-01-03 (Session 14): Added local template folder list + ownership cues for container lifecycle actions.
  - Host Settings now loads the templates directory list and surfaces it beneath containers with refresh + error states.
  - Container cards show an Ownership hint (local template vs external) based on compose project names.
  - Clarified lifecycle action scope with copy tied to local template folders.
- 2026-01-03 (Session 15): Completed localhost forwarding flow (Cloudflare-only, no Docker).
  - Added `/api/v1/projects/forward` backend job to update DNS + ingress without compose or docker run.
  - Wired Home "Forward localhost service" panel to the new forward-local endpoint and tightened validation/copy.
  - Removed unused local project loading from HomeView for this flow.
- 2026-01-03 (Session 16): Completed container lifecycle + host UI refinements.
  - Host Settings now lists running + stopped containers with status/project filters, restart limited to stopped, and action icons for lifecycle/logs.
  - Added Docker usage summary with project-scoped counts plus new `/api/v1/host/docker/usage` backend endpoint.
  - Sidebar header now shows the GitHub auth indicator; logout redirects to `/login`.
  - Added refresh/edit/login/logout iconography and a global page-loading overlay wired to initial view loads.
- 2026-01-03 (Session 17): Reviewed backlog and selected the next backend enhancement.
  - Picked legacy cleanup guard (review.md) as the next task to prevent startup warnings on fresh schemas.
- 2026-01-03 (Session 18): Completed BACKEND-CLEANUP-1.
  - Guarded legacy host-worker cleanup by skipping updates when host_token columns are absent and only updating existing legacy fields.
- 2026-01-03 (Session 19): Reviewed backend backlog and selected the next task.
  - Next focus: backend template catalog allowlist (settings storage + catalog payload + create-from-template validation).
- 2026-01-03 (Session 20): Implemented backend template catalog allowlist storage + validation.
  - Added settings persistence for template sources with default/visibility fields.
  - Extended GitHub catalog response to include allowlisted templates and default selection.
  - Validated create-from-template template refs against allowlist and enforced selection in jobs.
- 2026-01-03 (Session 21): Planning update for GitHub App token flow.
  - Removed allowlist focus from planning docs in favor of GitHub App token strategy.
  - Defined plan to store GitHub App credentials in DB and update Host Settings guidance.
- 2026-01-04 (Session 1): Completed GH-APP-1/2/3 (GitHub App settings + token minting + Host Settings UI).
  - Added GitHub App credential fields to settings persistence, settings payloads/sources, and audit metadata.
  - Minted GitHub App installation tokens for create-from-template and use them for API + git clone auth.
  - Updated Host Settings to capture GitHub App credentials with guidance and permissions callout.
- 2026-01-04 (Session 2): Diagnosed GitHub template repo lookup 404 and captured docs notes.
  - Reviewed GitHub docs confirming App installation tokens are supported for template generation and require Administration (write) + Contents (read).
  - Narrowed likely 404 causes to app installation scope or repo visibility (template repo not installed/accessible or installation ID mismatch).
  - Added troubleshooting notes to backend planning docs.

- 2026-01-04 (Session 7): Added GitHub App template access diagnostics.
  - Added repo access diagnostics (checked/available + error detail/request ID) and installation owner lookup in GitHub catalog response.
  - Added guidance to template validation errors when the app installation cannot access the template repo.
  - Updated GitHub UI to display installation owner, access status, and error/request ID details.
- 2026-01-04 (Session 8): Fixed GitHub client response handling build errors.
  - Updated request ID and response metadata helpers to use `github.Response` with go-github v62.
  - Removed `AcceptedError` response handling that no longer exists in v62.
- 2026-01-04 (Session 9): Resolved remaining go-github v62 build errors and verified compile.
  - Reworked response meta helpers to accept `http.Response` and passed `github.Response.Response` where needed.
  - Removed a duplicate `err` redeclaration in `GitHubService` settings handling.
  - `go build -o /tmp/server ./cmd/server` now succeeds locally.
- 2026-01-04 (Session 10): GitHub App token flow confirmed and permissions issue resolved.
  - Required permissions clarified (Administration: write, Contents: read, Metadata: read) and installation access fixed.
  - New blocker identified: template repo clone not materializing under `/templates`, causing `docker-compose.yml` missing error.
- 2026-01-04 (Session 11): Template clone reliability fix.
  - Added clone retry with cleanup and compose file existence check before port patching.
  - Template creation now waits for `/templates/<project>/docker-compose.yml` to exist before proceeding.
- 2026-01-04 (Session 12): Surfaced templates directory source in Host Settings.
  - Added templates dir value and source to settings response for UI display.
  - Host Settings now shows the resolved templates directory alongside tunnel/config status.
- 2026-01-04 (Session 13): Planned dynamic compose port patching.
  - Noted create-from-template failure when compose ports don't match default patterns.
  - Updated next task to implement flexible port injection + better logs.
- 2026-01-04 (Session 14): Implemented flexible compose port patching.
  - Updated compose port patching to match host mappings for container ports 80/5432, including env-substituted and IP-bound patterns.
  - Logged patch results per port (pattern used, already-set notes, or precise missing-mapping reasons).
  - Preserved compose file output unless actual changes were applied.
- 2026-01-04 (Session 15): Added role-aware session payload and middleware helpers.
  - Included user role in session encoding/decoding and surfaced it in `/auth/me` and test-token responses.
  - Added role-aware middleware helpers for RequireUser/RequireAdmin/RequireSuperUser with rank checks.
  - Introduced the admin role constant to round out RBAC scaffolding.
- 2026-01-07: Updated the GitHub view allowlist summary to source users from `/api/v1/users`.
  - Added allowlist loading to the GitHub view and replaced env-based labels with user list data.
  - Refresh now pulls both catalog and allowlist users together for updated counts.
- 2026-01-07: Fixed bootstrap APP_ENV value to align with secure cookie enforcement.
  - Updated generated `.env` to use `APP_ENV=prod` so backend secure cookies enable in production.
- 2026-01-18: Wired the favicon assets into the frontend entry HTML.
  - Replaced the default Vite icon links with the favicon set from `public/favicon_io`.
- 2026-01-18: Added a five-click mock login path with a prompt-based passphrase and local mock API data.
  - Added `mock.json` plus a localStorage flag to return mock API responses and bypass OAuth for frontend tweaks.

## Completed Task Snapshot

- UI-REWORK-1: All pages content: Remove rounded containers, reduce horizontal margins to ~5%, and use custom `<hr>` separators.
- UI-REWORK-2: All application forms: Create a shared `FormSidePanel` component for all forms, with a right-side slide-in animation and overlay.
- UI-REWORK-3: Refactor the first form to use the new `FormSidePanel`.
- UI-REWORK-4: Refactor all remaining forms to use `FormSidePanel` (HomeView deploy existing, HomeView quick service, HostSettingsView settings).
- UI-REWORK-5: Refactor HomeView to a more concise, componentized approach. Break down the large view into smaller, reusable components (e.g., HostStatusPanel, TemplateCardsSection, ServiceCardsSection).
- UI-REWORK-6: Standardize sidebar animations for both navigation and form sidebars. Create smooth, consistent open/close animations with proper timing and easing.
- UX-REFINE-1: Quick Services improvements - Add service icons, search bar, fixed-height scrollable container matching Templates section height.
- UX-REFINE-2: Redesign guidance system - Replace overlay-with-highlight with large-font contextual help on form field focus, positioned on left side opposite form, with external links (GitHub, Cloudflare) when applicable.
- UX-REFINE-3: Ingress preview sidebar - Convert live ingress preview to a sidebar panel (like FormSidePanel) for visual cleanup in Networking and Host Settings.
- UX-REFINE-4: Networking DNS grid - Convert 'Expected DNS records' section to a 4-column grid layout for compact info display.
- UX-REFINE-5: Template form clarification - Update 'Create from template' form to only include: Project name (required), Subdomain (required, not optional). Remove Proxy/DB port fields (auto-inferred).
- UX-REFINE-6: Deploy existing clarification - Update 'Deploy existing' form to forward ANY localhost service (Docker or not) with fields: Project name (identification), Subdomain (web exposure), Running At (localhost port). Cloudflare-only, no Docker involvement.
- GITHUB-GEN-1: Review GitHub template generate docs with ref.tools and capture endpoint specifics + payloads.
- GITHUB-GEN-2: Define GitHub App token requirements (permissions, installation flow, storage).
- GITHUB-GEN-3: Add backend plan for template catalog + repo allowlist + generate endpoint workflow.
- HOME-TEMPLATE-1: Add template repo selector and empty state in Home > Create from template.
- HOME-TEMPLATE-2: Add local repo list for lifecycle actions (stop/restart) and clarify ownership.
- FORWARD-LOCAL-1: Add backend + UI flow for forwarding localhost service via Cloudflare only (no Docker).
- HOST-CONTAINERS-1: List running + stopped containers, add filter toggles, and restrict restart to stopped.
- HOST-CONTAINERS-2: Add action icons for stop/restart/remove/logs.
- HOST-DOCKER-1: Add basic Docker usage summary (disk usage + counts).
- HOST-DOCKER-2: Add project-based filters for containers/volumes/images.
- SIDEBAR-AUTH-1: Replace sidebar logo header with GitHub auth indicator.
- UI-LOADING-1: Add global loading overlay for page-level loads.
- UI-ICONS-1: Add iconography for refresh/edit/login/logout buttons.
- AUTH-REDIRECT-1: Redirect to login on logout.
- BACKEND-CLEANUP-1: Guard legacy host-worker cleanup when host_token columns are absent to avoid startup warnings on fresh schemas.
- BACKEND-GH-CATALOG-1: Add template catalog allowlist storage in settings (multiple owner/repo entries, default template, visibility).
- BACKEND-GH-CATALOG-2: Extend `/api/v1/github/catalog` to return the allowlisted template list + default selection.
- BACKEND-GH-CATALOG-3: Update create-from-template to accept `template` (owner/repo) and validate against allowlist.
- GH-APP-1: Store GitHub App credentials in settings (App ID, Client ID, Client Secret, Installation ID, Private Key).
- GH-APP-2: Implement GitHub App token minting (JWT -> installation/user token) and use it for create-from-template.
- GH-APP-3: Update Host Settings UI to accept GitHub App credentials with setup guidance + permissions.
- 2026-01-21: Refactored the Gungnr CLI into layered packages and added a Bubbletea TUI.
  - Split bootstrap logic into app steps, integrations, prompts, validation, and shared strings.
  - Added a Bubbletea-driven TUI with step progress, prompts, and summary, plus a --plain fallback.
  - Updated Go module dependencies to Go 1.25 with Bubbletea v1.3.x and related UI libs.
